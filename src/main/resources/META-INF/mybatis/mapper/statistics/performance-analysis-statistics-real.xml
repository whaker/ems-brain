<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.identity.ems.mapper.statistics.PerformanceAnalysisRealStatisticsMapper">
	<update id="createTable">
	<![CDATA[
        CREATE TABLE IF NOT EXISTS `STATISTICS_ANALYSIS_R_${buildingIdx}` (
          `DATE` char(8) NOT NULL COMMENT '통계일자',
          `TIME` char(4) NOT NULL COMMENT '통계시간',
          `FACT_MASTER_IX` bigint(20) unsigned NOT NULL DEFAULT '0' COMMENT '설비정보 시퀀스',
          `PERFORMANCE_IDX` bigint(20) unsigned NOT NULL COMMENT '설비성능정보 시퀀스',
          `ANALY_VALUE` decimal(20,5) NOT NULL DEFAULT '0.00000' COMMENT '성능 측정값',
          `EXT_INPUT_FLAG` char(1) NOT NULL DEFAULT 'N' COMMENT '외부입력 여부',
          `CREATE_ID` varchar(12) NOT NULL COMMENT '생성ID',
          `CREATE_DATE` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '생성날짜',
          `UPDATE_ID` varchar(12) DEFAULT NULL COMMENT '변경ID',
          `UPDATE_DATE` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '변경날짜',
          PRIMARY KEY (`PERFORMANCE_IDX`,`FACT_MASTER_IX`,`DATE`,`TIME`),
          KEY `R_97` (`FACT_MASTER_IX`)
        ) ENGINE=MyISAM DEFAULT CHARSET=utf8 COMMENT='설비성능 실시간통계_#빌딩정보 시퀀스#';
	]]>
	</update>

	<insert id="save">
	<![CDATA[
        INSERT INTO statistics_analysis_r_1 (
            DATE,
            TIME,
            FACT_MASTER_IX,
            PERFORMANCE_IDX,
            ANALY_VALUE,
            EXT_INPUT_FLAG,
            CREATE_ID)
        VALUES (
            #{statistic.date},
            #{statistic.time},
            #{statistic.facilityIdx},
            #{statistic.performanceIdx},
            #{statistic.analysisValue},
            'N',
            'SYSTEM')
        ON DUPLICATE KEY UPDATE
            ANALY_VALUE = #{statistic.analysisValue}
	]]>
	</insert>

</mapper>
